{
  "type": "json_schema",
  "name": "enriched_endpoint",
  "strict": true,
  "schema": {
    "type": "object",
    "properties": {
      "api_id": {
        "type": "number",
        "description": "The API ID for this endpoint"
      },
      "endpoint_id": {
        "type": "number",
        "description": "The endpoint ID"
      },
      "headers": {
        "anyOf": [
          {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string"
                },
                "value": {
                  "type": "string"
                },
                "enabled": {
                  "type": "boolean"
                }
              },
              "required": [
                "name",
                "value",
                "enabled"
              ],
              "additionalProperties": false
            }
          },
          {
            "type": "null"
          }
        ],
        "description": "HTTP headers to send with the request"
      },
      "pathParams": {
        "anyOf": [
          {
            "type": "object",
            "additionalProperties": {
              "type": [
                "string",
                "number",
                "boolean",
                "null"
              ]
            }
          },
          {
            "type": "null"
          }
        ],
        "description": "Path parameters for the request"
      },
      "queryParams": {
        "anyOf": [
          {
            "type": "object",
            "additionalProperties": {
              "type": [
                "string",
                "number",
                "boolean",
                "null"
              ]
            }
          },
          {
            "type": "null"
          }
        ],
        "description": "Query parameters for the request"
      },
      "body": {
        "anyOf": [
          {
            "type": "object",
            "additionalProperties": {
              "type": [
                "string",
                "number",
                "boolean",
                "null"
              ]
            }
          },
          {
            "type": "null"
          }
        ]
      },
      "assertions": {
        "anyOf": [
          {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "string",
                  "description": "Unique ID for the assertion"
                },
                "data_id": {
                  "type": "string",
                  "description": "JSONPath or status_code"
                },
                "enabled": {
                  "type": "boolean"
                },
                "operator": {
                  "type": "string",
                  "enum": [
                    "equals",
                    "not_equals",
                    "contains",
                    "exists",
                    "greater_than",
                    "less_than",
                    "starts_with",
                    "ends_with",
                    "matches_regex",
                    "is_empty",
                    "greater_than_or_equal",
                    "less_than_or_equal",
                    "between",
                    "not_between",
                    "has_length",
                    "length_greater_than",
                    "length_less_than",
                    "contains_all",
                    "contains_any",
                    "is_type",
                    "is_null",
                    "is_not_null"
                  ]
                },
                "data_source": {
                  "type": "string",
                  "enum": [
                    "response",
                    "transformed_data"
                  ]
                },
                "assertion_type": {
                  "type": "string",
                  "enum": [
                    "status_code",
                    "json_body",
                    "response_time",
                    "header"
                  ]
                },
                "expected_value": {
                  "anyOf": [
                    {
                      "type": "string"
                    },
                    {
                      "type": "number"
                    },
                    {
                      "type": "boolean"
                    },
                    {
                      "type": "array",
                      "items": {
                        "type": [
                          "string",
                          "number",
                          "boolean",
                          "null"
                        ]
                      }
                    },
                    {
                      "type": "null"
                    }
                  ]
                },
                "expected_value_type": {
                  "type": "string",
                  "enum": [
                    "number",
                    "string",
                    "boolean",
                    "array",
                    "object",
                    "null"
                  ]
                }
              },
              "required": [
                "id",
                "data_id",
                "enabled",
                "operator",
                "data_source",
                "assertion_type",
                "expected_value",
                "expected_value_type"
              ],
              "additionalProperties": false
            }
          },
          {
            "type": "null"
          }
        ],
        "description": "Assertions to validate the response"
      },
      "transformations": {
        "anyOf": [
          {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "alias": {
                  "type": "string",
                  "description": "Alias name for the extracted value"
                },
                "expression": {
                  "type": "string",
                  "description": "JSONPath expression to extract the value"
                }
              },
              "required": [
                "alias",
                "expression"
              ],
              "additionalProperties": false
            }
          },
          {
            "type": "null"
          }
        ],
        "description": "Data transformations to extract values from response"
      }
    },
    "required": [
      "api_id",
      "endpoint_id",
      "headers",
      "pathParams",
      "queryParams",
      "body",
      "assertions",
      "transformations"
    ],
    "additionalProperties": false,
    "$schema": "http://json-schema.org/draft-07/schema#"
  }
}